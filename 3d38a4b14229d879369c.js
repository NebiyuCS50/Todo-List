import{createProject,createTodo,projects}from"./createTodo.js";import"./style.css";import renderAllTodos from"./all.js";import renderCompletedTodos from"./completed.js";import renderTodayTodos from"./today.js";import renderUpcomingTodos from"./upcoming.js";import renderDelayedTodos from"./delayed.js";function saveProjectsToLocalStorage(){localStorage.setItem("projects",JSON.stringify(projects))}function loadProjectsFromLocalStorage(){const t=localStorage.getItem("projects");if(t){const e=JSON.parse(t);projects.length=0,e.forEach(t=>projects.push(t))}}loadProjectsFromLocalStorage(),renderAllTodos();export const btnCreate=document.querySelector(".btn");export let editing=null;export function setEditing(t){editing=t}export let modalOverlay=null;btnCreate.addEventListener("click",()=>{const t=document.createElement("div");t.classList.add("modal-overlay");const e=document.createElement("div");e.classList.add("modal-content");const o=document.createElement("form");o.classList.add("form");const d=document.createElement("div");d.classList.add("title"),d.textContent="Welcome, ";const n=document.createElement("br");d.appendChild(n);const i=document.createElement("span");i.textContent="Let's create your first project",d.appendChild(i);const r=document.createElement("input");r.placeholder="Todo Project Name",r.name="name",r.classList.add("input");const s=document.createElement("input");s.placeholder="Todo Title",s.name="title",s.classList.add("input");const c=document.createElement("input");c.placeholder="Todo Description",c.name="description",c.classList.add("input");const a=document.createElement("input");a.placeholder="Todo Due Date",a.name="dueDate",a.classList.add("input"),a.type="date";const l=document.createElement("input");l.placeholder="Created At",l.name="createdAt",l.classList.add("input"),l.value=(new Date).toISOString().split("T")[0],l.readOnly=!0;const p=document.createElement("label");p.classList.add("label"),p.textContent="Priority";const u=document.createElement("select");u.classList.add("input-select");const m=document.createElement("option");m.classList.add("option-low"),m.value="low",m.textContent="Low";const h=document.createElement("option");h.classList.add("option-medium"),h.value="medium",h.textContent="Medium";const g=document.createElement("option");g.classList.add("option-high"),g.value="high",g.textContent="High",u.addEventListener("change",()=>{u.classList.remove("priority-low","priority-medium","priority-high");const t=u.value;"low"===t?u.classList.add("priority-low"):"medium"===t?u.classList.add("priority-medium"):"high"===t&&u.classList.add("priority-high")}),u.appendChild(m),u.appendChild(h),u.appendChild(g),p.appendChild(u);const y=document.createElement("button");y.classList.add("btn-create"),y.textContent=editing?"Update Project":"Create Project â†’",o.appendChild(d),o.appendChild(r),o.appendChild(s),o.appendChild(c),o.appendChild(a),o.appendChild(l),o.appendChild(p),o.appendChild(y),e.appendChild(o),t.appendChild(e),document.body.appendChild(t),editing&&(r.value=editing.project.name,s.value=editing.todo.title,c.value=editing.todo.description,a.value=editing.todo.dueDate,u.value=editing.todo.priority),t.addEventListener("click",e=>{e.target===t&&(t.remove(),editing=null)}),o.addEventListener("submit",e=>{e.preventDefault();const d=r.value,n=s.value,i=c.value,p=a.value,m=u.value;if(d&&n&&i&&m&&p)if(p<(new Date).toISOString().split("T")[0])alert("Due date cannot be before the created date.");else{if(editing){editing.project.name=d,editing.todo.title=n,editing.todo.description=i,editing.todo.dueDate=p,editing.todo.priority=m,editing.card.querySelector(".card-project").textContent=d,editing.card.querySelector(".card-todo").textContent=n,editing.card.querySelector(".card-description").textContent=i,editing.card.querySelector(".card-due-date").textContent=`Due Date: ${p}`,editing.card.querySelector(".card-priority").textContent=`Priority: ${m}`;const t=editing.card.querySelector(".card-priority");t.textContent=`Priority: ${m}`,t.classList.remove("priority-low","priority-medium","priority-high"),"low"===m?t.classList.add("priority-low"):"medium"===m?t.classList.add("priority-medium"):"high"===m&&t.classList.add("priority-high"),editing=null}else{const e=createProject(d),o=createTodo(n,i,m,p,!1);e.todos.push(o),projects.push(e);const r=document.querySelector(".form-right"),s=document.createElement("div");s.classList.add("card"),s.dataset.todoId=o.id;const c=document.createElement("h2");c.classList.add("card-project"),c.textContent=d;const a=document.createElement("h3");a.classList.add("card-todo"),a.textContent=n;const u=document.createElement("p");u.classList.add("card-description"),u.textContent=i;const h=document.createElement("p");h.classList.add("card-created-at"),h.textContent=`Created At: ${l.value}`,h.style.pointerEvents="none";const g=document.createElement("p");g.classList.add("card-due-date"),g.textContent=`Due Date: ${p}`;const y=document.createElement("p");y.classList.add("card-priority"),y.textContent=`Priority: ${m}`,y.textContent=`Priority: ${m}`,y.classList.remove("priority-low","priority-medium","priority-high"),"low"===m?y.classList.add("priority-low"):"medium"===m?y.classList.add("priority-medium"):"high"===m&&y.classList.add("priority-high");const C=document.createElement("label");C.classList.add("checkbox-container");const L=document.createElement("input");L.classList.add("custom-checkbox"),L.checked="",L.type="checkbox";const v=document.createElement("span");v.classList.add("checkmark");const w=document.createElement("span");w.classList.add("checkmark2"),w.textContent="Completed",L.addEventListener("change",()=>{o.completed=L.checked,L.checked?w.style.color="#4CAF50":w.style.color="",saveProjectsToLocalStorage()}),C.appendChild(L),C.appendChild(v),C.appendChild(w);const b=document.createElement("div");b.classList.add("card-buttons");const E=document.createElement("button");E.classList.add("Btn-edit"),E.dataset.todoId=o.id,E.textContent="Edit",E.addEventListener("click",e=>{e.preventDefault();const o=Number(E.dataset.todoId),d=projects.find(t=>t.todos.some(t=>t.id===o)),n=d?.todos.find(t=>t.id===o);n&&(editing={project:d,todo:n,card:s},t.remove(),btnCreate.click())});const f=document.createElementNS("http://www.w3.org/2000/svg","svg");f.setAttribute("class","svg"),f.setAttribute("viewBox","0 0 512 512");const x=document.createElementNS("http://www.w3.org/2000/svg","path");x.setAttribute("d","M410.3 231l11.3-11.3-33.9-33.9-62.1-62.1L291.7 89.8l-11.3 11.3-22.6 22.6L58.6 322.9c-10.4 10.4-18 23.3-22.2 37.4L1 480.7c-2.5 8.4-.2 17.5 6.1 23.7s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L387.7 253.7 410.3 231zM160 399.4l-9.1 22.7c-4 3.1-8.5 5.4-13.3 6.9L59.4 452l23-78.1c1.4-4.9 3.8-9.4 6.9-13.3l22.7-9.1v32c0 8.8 7.2 16 16 16h32zM362.7 18.7L348.3 33.2 325.7 55.8 314.3 67.1l33.9 33.9 62.1 62.1 33.9 33.9 11.3-11.3 22.6-22.6 14.5-14.5c25-25 25-65.5 0-90.5L453.3 18.7c-25-25-65.5-25-90.5 0zm-47.4 168l-144 144c-6.2 6.2-16.4 6.2-22.6 0s-6.2-16.4 0-22.6l144-144c6.2-6.2 16.4-6.2 22.6 0s6.2 16.4 0 22.6z"),f.appendChild(x),E.appendChild(f);const k=document.createElement("button");k.setAttribute("type","button"),k.classList.add("button"),k.dataset.todoId=o.id;const A=document.createElement("span");A.classList.add("button__text"),A.textContent="Delete";const S=document.createElement("span");S.classList.add("button__icon");const j=document.createElementNS("http://www.w3.org/2000/svg","svg");j.setAttribute("xmlns","http://www.w3.org/2000/svg"),j.setAttribute("width","512"),j.setAttribute("height","512"),j.setAttribute("viewBox","0 0 512 512"),j.classList.add("svg");const T=document.createElementNS("http://www.w3.org/2000/svg","path");T.setAttribute("style","fill:none;stroke:#fff;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px"),T.setAttribute("d","M112,112l20,320c.95,18.49,14.4,32,32,32H348c17.67,0,30.87-13.51,32-32l20-320"),j.appendChild(T);const D=document.createElementNS("http://www.w3.org/2000/svg","line");D.setAttribute("x1","80"),D.setAttribute("y1","112"),D.setAttribute("x2","432"),D.setAttribute("y2","112"),D.setAttribute("style","stroke:#fff;stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"),j.appendChild(D);const P=document.createElementNS("http://www.w3.org/2000/svg","path");P.setAttribute("style","fill:none;stroke:#fff;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px"),P.setAttribute("d","M192,112V72h0a23.93,23.93,0,0,1,24-24h80a23.93,23.93,0,0,1,24,24h0v40"),j.appendChild(P);const N=document.createElementNS("http://www.w3.org/2000/svg","line");N.setAttribute("x1","256"),N.setAttribute("y1","176"),N.setAttribute("x2","256"),N.setAttribute("y2","400"),N.setAttribute("style","fill:none;stroke:#fff;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px"),j.appendChild(N);const q=document.createElementNS("http://www.w3.org/2000/svg","line");q.setAttribute("x1","184"),q.setAttribute("y1","176"),q.setAttribute("x2","192"),q.setAttribute("y2","400"),q.setAttribute("style","fill:none;stroke:#fff;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px"),j.appendChild(q);const B=document.createElementNS("http://www.w3.org/2000/svg","line");B.setAttribute("x1","328"),B.setAttribute("y1","176"),B.setAttribute("x2","320"),B.setAttribute("y2","400"),B.setAttribute("style","fill:none;stroke:#fff;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px"),k.addEventListener("click",t=>{t.preventDefault();const e=Number(k.dataset.todoId);projects.forEach(t=>{t.todos=t.todos.filter(t=>t.id!==e)}),s.remove(),saveProjectsToLocalStorage()}),j.appendChild(B),S.appendChild(j),k.appendChild(A),k.appendChild(S),s.appendChild(c),s.appendChild(a),s.appendChild(u),s.appendChild(h),s.appendChild(g),s.appendChild(y),s.appendChild(C),b.appendChild(E),b.appendChild(k),s.appendChild(b),r.appendChild(s)}o.reset(),l.value=(new Date).toISOString().split("T")[0],t.remove(),saveProjectsToLocalStorage()}else alert("Please fill in all fields")})});const allBtn=document.querySelector(".left button:nth-child(1)"),completedBtn=document.querySelector(".left button:last-child"),todayBtn=document.querySelector(".left button:nth-child(2)"),upcomingBtn=document.querySelector(".left button:nth-child(3)"),delayedBtn=document.querySelector(".left button:nth-child(4)");todayBtn.addEventListener("click",renderTodayTodos),upcomingBtn.addEventListener("click",renderUpcomingTodos),delayedBtn.addEventListener("click",renderDelayedTodos),allBtn.addEventListener("click",renderAllTodos),completedBtn.addEventListener("click",renderCompletedTodos);